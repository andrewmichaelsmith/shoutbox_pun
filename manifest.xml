<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE extension SYSTEM "ext-1.0.dtd">

<!--
***********************************************************************

    PunBB 1.4 Extension - shoutbox_pun
    Copyright (C) 2012 Andrew Smith

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see http://www.gnu.org/licenses/.

***********************************************************************
-->

<extension engine="1.0">
	<id>shoutbox_pun</id>
	<title>PunBB Shoutbox</title>
	<version>7.0.9</version>
	<description>Puts a shoutbox underneath the forum</description>
	<author>andrewmichaelsmith</author>

	<minversion>1.4.0</minversion>
	<maxtestedon>1.4.1</maxtestedon>
	
	<install><![CDATA[
	
	if (!$forum_db->table_exists('pun_shout'))
  {
  $schema = array(
		'FIELDS'			=> array(
  			'id'				=> array(
  				'datatype'		=> 'SERIAL',
  				'allow_null'	=> false
  			),
  			'userid'			=> array(
  				'datatype'		=> 'INT(10) UNSIGNED',
  				'allow_null'	=> false,
  				'default'		=> '0'
  			),
  			'date'			=> array(
  				'datatype'		=> 'INT(20) UNSIGNED',
  				'allow_null'	=> false,
  				'default'		=> '0'
  			),
  			'shout'			=> array(
  				'datatype'		=> 'VARCHAR(255)',
  				'allow_null'	=> false,
  				'default'		=> '\'\''
  			)
  		),
  		
  			'PRIMARY KEY'	=> array('id')
  	);
  			
  $forum_db->create_table('pun_shout', $schema);
 }	
	
	]]></install>
	
	<uninstall><![CDATA[

$forum_db->drop_table('pun_shout');

	]]></uninstall>

	
	<hooks>
		
			<hook id="hd_head"><![CDATA[
if (defined('FORUM_PAGE') && FORUM_PAGE == 'index')
{
	if (file_exists($ext_info['path'].'/style/'.$forum_user['style'].'/'.$ext_info['id'].'.css'))
		$forum_head['style_online_plus'] = '<link rel="stylesheet" type="text/css" media="screen" href="'.$ext_info['url'].'/style/'.$forum_user['style'].'/'.$ext_info['id'].'.css" />';
	else
		$forum_head['style_online_plus'] = '<link rel="stylesheet" type="text/css" media="screen" href="'.$ext_info['url'].'/style/Oxygen/'.$ext_info['id'].'.css" />';
}
		]]></hook>
		
		<hook id="in_info_output_start"><![CDATA[
		?>
<script src="<?=$ext_info['path']?>/js/jquery-1.7.1.min.js"></script>
<script src="<?=$ext_info['path']?>/js/iscroll.js"></script>
<script src="<?=$ext_info['path']?>/js/shoutbox-pun.js"></script>


<form id="shoutform">
		<input type="text" class="sbox" id="shout" color="white" size="100" maxlength="250">
		<img src="<?=$ext_info['path']?>/loading.gif" alt="Loading..." id="loading" width="16" height="16"/>
		<span id="error"></span>
    <div class="sbox" id="sbox">
    <div id="shoutbox">
    </div>
    </div>
</form>
		<?php
		]]></hook>
			</hooks>
</extension>
